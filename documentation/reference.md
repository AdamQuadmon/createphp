[CreatePHP Documentation](index.md)

# Reference

## Type system: Types, Entities and Collections

CreatePHP defines interfaces for the definition of RDF types, properties and
collections. Then it defines extended interfaces for types bound to actual
values. Think of: type = class, entity = object.

Additionally, type definitions may implement the NodeInterface to expose
functionality to render themselves in a DOM-like logic.

The normal workflow is to create the Type, PropertyDefinition and
CollectionDefinition instances, configure eventual settings (including Node
settings if they implement NodeInterface) and then bind the type to a domain
model object with createWithObject. createWithObject returns the Entity for
this type bound to the value.


### Collections

A collection is a list of children entities of an entity. A collection may
contain children of different types, but the metadata must specify the allowed
child types. In the RDFa model, collections have a couple of attributes:

* ``about`` the containing subject (can be inherited from containing HTML)
* ``rel`` identifies the HTML element as a container of a collection. The value
of the ``rel`` attribute is irrelevant for create.js and VIE.
* ``rev`` if present, defines the attribute to be used on newly created entities
in that collection that links back to the containing entity as specified in
``about``. Createphp uses this to determine the parent entity when persisting a
new entity.


## Metadata Factory

To avoid building the type tree with verbose code, there is the
Metadata\RdfTypeFactory. It provides TypeInterface instances for given class
names. There are several drivers available:

* RdfDriverArray: You pass in an array of configuration when bootstrapping the
  driver (i.e. through ArrayLoader)
* RdfDriverXml: Reads XML files with configuration, following a naming scheme
* RdfDriverFeelingLucky: Uses introspection to guess at properties. Good for a
  quick hack, but does not produce meaningful RDF.

Look at the driver phpdoc for the exact syntax to use for configuration.


## Twig Extension

This library contains an extension to render objects in the
[twig templating language](http://twig.sensiolabs.org/).
Add the Midgard\CreatePHP\Extension\Twig\CreatephpExtension to your twig
environment to get the following constructs:

    {% createphp mymodel %}{{ mymodel_rdf|raw }}{% endcreatephp %}

The createphp tag loads your domain model object into the EntityInterface
instance with the help of the RdfTypeFactory. You can specify the name for the
rdf entity inside the createphp tag with the "as" attribute:
``{% createphp mymodel as="yourname" %}``. If you do not specify a name, the
name is generated by appending "_rdf" to your model name.

Inside the createphp tag, you can render the entity with the default structure
(see above), or render single fields as in the example below:

    {% createphp mymodel noautotag %}
    <div class="my-section" {{ createphp_attributes(mymodel_rdf) }}>
        <h1 class="my-title" {{ createphp_attributes( mymodel_rdf.title ) }}>{{ createphp_content( mymodel_rdf.title ) }}</h1>
        {{ mymodel_rdf.content|raw }}
    </div>
    {% endcreatephp %}

With ``noautotag`` the enclosing elements are not rendered automatically. Therefore,
you need to render the attributes of the entity in a tag that encloses all of
your entity. Inside that tag, you can place arbitrary HTML and render single
fields or render attributes and content of the fields separately for closer
control over the generated HTML.
Note the ``|raw`` filter after rendering the full entity or a complete field.

